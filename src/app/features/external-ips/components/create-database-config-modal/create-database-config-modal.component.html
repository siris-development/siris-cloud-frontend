@if (isVisible) {
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
      <div class="px-6 py-4 border-b border-slate-200">
        <h3 class="text-lg font-semibold text-slate-900">Nueva Configuración de Base de Datos Externa</h3>
      </div>
      
      <form (ngSubmit)="onCreate()" class="p-6 space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Nombre del Sistema *</label>
            <input
              type="text"
              [(ngModel)]="newConfig().systemName"
              name="systemName"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('systemName') ? 'border-red-500' : 'border-slate-300')"
              required>
            @if (hasFieldError('systemName')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('systemName') }}</p>
            }
          </div>
          
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">NIT *</label>
            <input
              type="text"
              [(ngModel)]="newConfig().nit"
              name="nit"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('nit') ? 'border-red-500' : 'border-slate-300')"
              required>
            @if (hasFieldError('nit')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('nit') }}</p>
            }
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Host de Base de Datos *</label>
            <input
              type="text"
              [(ngModel)]="newConfig().host"
              name="host"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('host') ? 'border-red-500' : 'border-slate-300')"
              placeholder="192.168.1.100 o servidor-bd.com"
              required>
            @if (hasFieldError('host')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('host') }}</p>
            }
          </div>
          
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Puerto de Base de Datos *</label>
            <input
              type="number"
              [(ngModel)]="newConfig().port"
              name="port"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('port') ? 'border-red-500' : 'border-slate-300')"
              min="1"
              max="65535"
              required>
            @if (hasFieldError('port')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('port') }}</p>
            }
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Nombre de la Base de Datos *</label>
          <input
            type="text"
            [(ngModel)]="newConfig().databaseName"
            name="databaseName"
            (blur)="validateForm()"
            [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('databaseName') ? 'border-red-500' : 'border-slate-300')"
            placeholder="mi_base_datos"
            required>
          @if (hasFieldError('databaseName')) {
            <p class="mt-1 text-sm text-red-600">{{ getFieldError('databaseName') }}</p>
          }
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Usuario de Base de Datos *</label>
            <input
              type="text"
              [(ngModel)]="newConfig().username"
              name="username"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('username') ? 'border-red-500' : 'border-slate-300')"
              autocomplete="off"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false"
              data-form-type="other"
              required>
            @if (hasFieldError('username')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('username') }}</p>
            }
          </div>
          
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Contraseña de Base de Datos *</label>
            <input
              type="password"
              [(ngModel)]="newConfig().password"
              name="password"
              (blur)="validateForm()"
              [class]="'w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ' + (hasFieldError('password') ? 'border-red-500' : 'border-slate-300')"
              autocomplete="new-password"
              autocorrect="off"
              autocapitalize="off"
              spellcheck="false"
              data-form-type="other"
              data-lpignore="true"
              required>
            @if (hasFieldError('password')) {
              <p class="mt-1 text-sm text-red-600">{{ getFieldError('password') }}</p>
            }
          </div>
        </div>




        <div class="flex justify-end space-x-3 pt-4">
          <button
            type="button"
            (click)="onClose()"
            class="px-4 py-2 text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors">
            Cancelar
          </button>
          <button
            type="submit"
            [disabled]="loading"
            class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50">
            @if (loading) {
              <div class="inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
            }
            Crear Base de Datos
          </button>
        </div>
      </form>
    </div>
  </div>
}
